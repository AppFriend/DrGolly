Prompt for Replit Developer (Admin Panel Plan Update Fix):

We are now working inside the feature/admin branch. Please focus exclusively on enhancing the plan management functionality in the Admin Panel. This prompt relates specifically to updating user plans via the subscription dropdown in the admin user editor.

Current Behaviour:
When editing a user in the admin panel (e.g. frazer.adnam@cq-partners.com.au), changing the plan from "Free" to "Gold" in the dropdown does not appear to update the plan in the database. As a result, none of the correct downstream logic is being triggered.

Expected Behaviour:
When the subscription plan is changed via the admin panel:

Database Update:
The user's subscription plan should be immediately and correctly updated in the backend database. This must persist and reflect across all relevant areas.

Frontend Display Update:
Once the database is updated, the following frontend UI elements should immediately reflect the change:

The plan badge in the "User Card Admin" view should update to "Gold"

The homepage experience for that user (when logged in) should change to reflect "Gold" plan benefits (banner, access, etc.)

Stripe Integration:
The userâ€™s plan change must be reflected in the Stripe subscription record. Ensure this uses existing Stripe integration logic.

Klaviyo Sync:
The updated plan information must be sent to Klaviyo using the existing integration flow so that segmentation and messaging stay accurate.

Testing Instructions (for both dev and prod):

In the admin panel, search for a test user (e.g. frazer.adnam@cq-partners.com.au)

Change plan from "Free" to "Gold"

Save and verify the following across environments:

Plan is updated in the database

Stripe subscription is updated correctly

Klaviyo receives the updated plan

Homepage renders the correct gold plan experience

Admin user card reflects updated plan badge

Repeat test for "Gold" > "Free" downgrade

Important Notes:

Do not modify any unrelated admin panel UI or logic.

Do not affect any other system outside of this plan update dropdown.

Please test thoroughly in both dev and production environments to ensure the fix is robust and behaves consistently across both.

Let me know once testing is confirmed and ready to deploy.